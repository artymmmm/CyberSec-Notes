## Источники информации
- [Access Control Topic PortSwigger Academy](https://portswigger.net/web-security/learning-paths/websockets-security-vulnerabilities/websockets/websockets/websockets)
## Вертикальное повышение привилегий
### Незащищенная функциональность
Пользователю без администраторских прав может быть доступна функциональность администратора, например, через прямую ссылку: `https://<target>/admin`. Такие ссылки можно найти перебором, либо анализом доступных пользователю файлов (ссылки могут быть в JS-файлах, HTML-страницах)
### Методы контроля доступов на основе параметров
Приложение может хранить информацию о правах пользователя в скрытом поле, куки, предустановленном параметре запроса (`https://<target>/login/home.jsp?role=1`, `"roleid": 1` в JSON POST-запросе). Изменив эти данные, атакующий сможет получить повышенные права
### Неправильная конфигурация
Приложение может ограничивать доступ к URL и методам в зависимости от роли (`DENY: POST, /admin/deleteUser, managers`). Данное ограничение можно обойти при помощи смены HTTP-метода. Также ограничение можно обойти с помощью нестандартных HTTP-заголовков, которые позволяют изменять URL в запросе (`X-Original-URL`, `X-Rewrite-URL`). Атакующий может обойти ограничения, изменив URL с разрешенного на неразрешенный с помощью заголовка:
```HTTP
GET /?user=carlos HTTP/1.1 
X-Original-URL: /admin/deleteUser 
```
### Неправильное сопоставление URL-адресов
При обращении к `/ADMIN/DELETEUSER` сервер может вернуть `/admin/deleteUser`, но не применить ограничения по ролям из-за различий в символах. В фреймворке Spring присутcтвует опция `useSuffixPatternMatch`, которая маппит путь с любым расширением файла к пути без расширения (запрос к `/admin/deleteUser.anything` будет отправлен к `/admin/deleteUser`), что также может позволить обойти ограничения. Аналогичная ситуация с `/admin/deleteUser` и `/admin/deleteUser/`
## Горизонтальное повышение привилегий
### Небезопасные прямые ссылки на объекты (Insecure Direct Object Reference, IDOR)
Небезопасные прямые ссылки на объекты (IDOR) - это тип уязвимости контроля доступа, возникающий, когда приложение использует предоставленные пользователем входные данные для прямого доступа к объектам.
Возможно получение несанкционированного доступа к данным путем изменения значений параметров в URL: `http://localhost:1337/receipt.php?orderID=3` (изменить значение `orderID` на другое). Когда используются значения, которые сложно предсказать (например, GUID), они могут отображаться в таких местах как комментарии или сообщения пользователей. В некоторых случаях приложение, когда у пользователя нет доступа к ресурсу, ответ, содержащий перенаправление на разрешенную страницу, может включать конфиденциальные данные целевого пользователя.
IDOR может быть эксплуатирован в случае хранения конфиденциальной информации (например, история чата) в статичных файлах на сервере. Перебирая названия файлов, атакующий может получить доступ к чужим файлам: `https://insecure-website.com/static/12144.txt`
### Уязвимости контроля доступа в многоэтапных процессах
Многие веб-сайты реализуют важные функции в несколько этапов. Это используется в следующих случаях:
- Необходимо получить множество входных данных или параметров
- Пользователю необходимо проверить и подтвердить данные перед выполнением действия. Например, административная функция обновления данных пользователя может включать следующие шаги:
	- Загрузка формы, содержащей данные конкретного пользователя
	- Отправка изменений
	- Проверка изменений и подтверждение
Иногда веб-сайт применяет строгий контроль доступа к некоторым из этих шагов, игнорируя другие. Веб-сайт предполагает, что пользователь доберется до последнего шага только после завершения первых шагов, которые должным образом контролируются. Атакующий может получить несанкционированный доступ к функции, пропустив первые два шага и напрямую отправив запрос на последний шаг с необходимыми параметрами.