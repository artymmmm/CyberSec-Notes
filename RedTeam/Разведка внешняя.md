## Сканирование
- ### Nmap
	 - Ping: `nmap -sn --traceroute <network: 10.0.0.0/24>`; `sudo nmap -sn -iL discovery/ranges.txt -oA discovery/hosts/pingsweep -PE` (`-iL` - список сканируемых диапазонов, `-oA` - каталог, в который будет записан вывод в нескольких форматах, `-PE` - ICMP echo)
	 - TCP: `(sudo) nmap -p0- -v -A -T4 <target: 10.0.0.1>` (`-p0` - все TCP порты, -v - увеличенный вывод, -A - агрессивное сканирование, -T4 - ускорение сканирования, с `sudo` запускается менее заметное `-sS` сканирование, без `sudo` запускается `-sT` сканирование)
	 - UDP: `sudo nmap -sU -T4 -F <target: 10.0.0.1>` (`-sU` - UDP-скан, -F - сканирование наиболее популярных 100 портов, -T4 - ускорение сканирования)
	 - Стандартный набор скриптов для порта: `nmap -Pn -n -p <port> -sC -v --open <target>`
	 - Скрипты: `sudo nmap --script <категория скриптов>|<директория>|<имя_файла>|all <target: example.com>`.
	 - Команды для сканирования: https://denisnovikov.github.io/blog/stunning-examples-of-nmap-commands/, https://www.stationx.net/nmap-cheat-sheet/
	 - Документация на русском: https://kali.tools/?p=1317
	 - Скрытность сканирования можно увеличить за счет уменьшения скорости (`-T0, -T1`), добавления случайных байтов к пакету (`--data-length`), перемешивания сканируемых узлов (`--randomize-hosts`)
- ### Masscan (сканирование крупных сегментов сети)
	- `masscan 10.0.0.0/8 192.168.0.0/16 172.16.0.0/12 -p80 --open-only` (сканирование трех сетей `10.0.0.0/8`, `192.168.0.0/16`, `172.16.0.0/12` по 80 порту)
- ### DNS
	 - `host <target: example.com>` (Linux) / `nslookup <target: example.com>` (Windows)
	 - Информация о домене: https://dnsdumpster.com/
	 - https://www.shodan.io/
	 - Брут форс DNS: https://github.com/blark/aiodnsbrute `aiodnsbrute -w wordlist.txt -vv -t 1024 domain.com`
- ### Сертификаты 
	 - Информация о сертификатах: https://crt.sh/
- ## Поддомены
	- Gobuster: `gobuster dir -u <http(s)://domain(:port)> -w <wordlist: /usr/share/wordlists/amass/>`, `gobuster vhost --append-domain -u <http(s)://domain(:port)> -w <wordlist: /usr/share/wordlists/amass/>`
	- Subfinder (пассивный поиск):  `subfinder -d <targer: example.com>`
- ### Директории и файлы
	- ffuf: 
		- `ffuf -w <wordlist> -u <target>/FUZZ -fc 403` (`-fc` - фильтр HTTP-ответов)
		- `ffuf -x '<host:port>' -w <wordlist> -u '<target>/FUZZ'` (`-x` - прокси)
`
	- Gobuster: `gobuster dir -u <target> -w <wordlist>`
- ### HTTP/HTTPS сайты в браузере
	- [Webshot](https://github.com/R3dy/webshot): делает снимки сайтов с целью обнаружения страниц администрирования веб-серверов, может использовать XML-файл из nmap
- ## Порты
	- ### Вне зависимости от ОС/Linux
		- 21 - FTP (File Transfer Protocol) - TCP
		- 22 (2222, 22222) - SSH (Secure Shell for Login) - TCP
		- 23 - Telnet - TCP
		- 25 (587 (submission), 465 (SMTPS)) - SMTP - TCP
		- 53 - DNS - TCP/UDP
		- 67 - DCHP Server - UDP
		- 68 - DHCP Client - 68
		- 80 (8080, 8008, 81, 8000) - HTTP (Hypertext Transfer Protocol) - TCP
		- 110 (995 (POP3S)) - POP3 (Post Office Protocol V3) - TCP 
		- 123 - NTP (Network Time Protocol) - UDP
		- 143 (993 (IMAPS)) - IMAP (Internet Message Access Protocol) - TCP
		- 443 (8443, 4443, 8000) - HTTPS - TCP
		- 1521 - OracleDB - TCP
		- 3306 (3307, 3308) - MySQL - TCP
		- 5432 - PostgreSQL - TCP
		- 5800 - Сервер Java VNC
		- 5900 - Сервер VNC
	- ### Windows
		-  88 - kerberos (Kerberos Key Distribution Center) - наличие этого порта помогает определить контроллер домена в сети.
		- 135 - MSRPC (Microsoft RPC) - используется в приложениях «клиент-сервер» Microsoft (например, Exchange), позволяет выполнять различные операции в OS при наличии учетных данных.
		- 137 - NETBIOS-NS (NetBIOS Name Service) - UDP/TCP - позволяет узнать доменное имя машины и ее MAC адрес.
		- 139 - NetBIOS Session Service - TCP
		- 389 - LDAP (Lightweight Directory Access Protocol) - этот порт может дать различные возможности, как по подбору учетных данных, так и по получению доступа к LDAP через эксплуатацию уязвимостей.
		- 445 - SMB (Server Message Blocks over IP) - TCP
		- 1433 (1434) - MSSQL (Microsoft SQL Server) - сервис MSSQL позволяет получить доступ к управлению БД и, что более важно, выполнить произвольный код на машине Windows, если у нас есть аккаунт для доступа к БД.
		- 3389 (3390, 3388) - RDP (Remote Desktop Protocol) - TCP - служба удаленных рабочих столов также имеет в истории различные уязвимости, приводящие к выполнению произвольного кода (BlueKeep), и уязвима по отношению к атакам MitM, позволяющим получить доступ к службе от имени жертвы.